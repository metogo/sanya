# 景点数据生成脚本

此脚本用于从 Excel 文件读取景点数据并生成 TypeScript 文件供项目使用。

## 使用方法

### 1. 更新数据

编辑项目根目录下的两个 Excel 文件：
- `三亚旅游景点 Top 榜单 (完整中文版).xlsx` - 中文数据
- `三亚旅游景点 Top 榜单 (完整俄语版).xlsx` - 俄语数据

### 2. 运行生成脚本

在项目根目录运行以下命令：

```bash
npm run generate:attractions
```

此命令会：
1. 读取两个 Excel 文件的数据
2. 合并中文和俄语数据
3. 自动生成 `src/data/attractions.ts` 文件

### 3. 验证结果

生成完成后，脚本会显示：
- ✅ 生成成功的确认消息
- 📊 处理的景点总数

## Excel 文件格式要求

### 中文版 Excel 列名（必需）：
- **ID** - 景点ID（数字）
- **景点名称** - 中文景点名
- **景点描述** - 中文描述
- **景点位置** - 中文地点
- **分类** - 景点类型（海滩/文化/自然/娱乐）
- **图片链接** - 景点图片URL
- **评分** - 评分（1-5）
- **评论数** - 评论数量
- **门票价格(元)** - 门票价格（0表示免费）
- **是否免费** - 是/否
- **标签** - 标签，用逗号分隔

### 俄语版 Excel 列名（必需）：
- **ID** - 景点ID（数字，需与中文版对应）
- **Название** - 俄文景点名
- **Описание** - 俄文描述
- **Расположение** - 俄文地点
- **Категория** - 景点类型（Пляж/Культура/Природа/Развлечения）
- **Ссылка на изображение** - 图片链接
- **Рейтинг** - 评分
- **Кол-во отзывов** - 评论数
- **Цена билета (CNY)** - 门票价格
- **Бесплатно?** - Да/Нет
- **Теги** - 标签，用逗号分隔

## 类别映射

脚本会自动将以下类别转换为标准格式：

| 中文 | 俄文 | 英文代码 | 显示图标 |
|------|------|---------|---------|
| 海滩 | пляж | beach | 🏖️ |
| 文化 | культура | culture | 🏛️ |
| 自然 | природа | nature | 🌴 |
| 娱乐 | развлечения | entertainment | 🎢 |

## 数据结构

生成的 TypeScript 文件包含以下字段：

```typescript
{
  id: string;           // 自动生成的 ID
  name: string;         // 英文名称
  nameRu: string;       // 俄文名称
  nameZh: string;       // 中文名称
  description: string;  // 英文描述
  descriptionRu: string;// 俄文描述
  descriptionZh: string;// 中文描述
  image: string;        // 图片 URL
  rating: number;       // 评分 (0-5)
  reviewCount: number;  // 评论数
  location: string;     // 英文地点
  locationRu: string;   // 俄文地点
  locationZh: string;   // 中文地点
  category: string;     // 类别代码
  categoryRu: string;   // 俄文类别（带图标）
  categoryEn: string;   // 英文类别（带图标）
  categoryZh: string;   // 中文类别（带图标）
  price: number;        // 价格
  isFree: boolean;      // 是否免费
  tags: string[];       // 标签数组
}
```

## 注意事项

1. **数据对齐**：确保中文版和俄语版的 Excel 文件中，景点的顺序是一致的
2. **行数匹配**：两个文件应该有相同数量的行
3. **必填字段**：名称、描述、类别是必填的
4. **图片URL**：如果没有提供图片链接，会使用默认图片
5. **价格**：0 或空表示免费景点

## 工作流程

当你更新 Excel 文件后的标准流程：

1. 编辑 Excel 文件
2. 保存文件
3. 运行 `npm run generate:attractions`
4. 查看生成的 `src/data/attractions.ts` 文件
5. 刷新网页查看更新后的数据

## 故障排除

### 错误：找不到文件
确保 Excel 文件在项目根目录，文件名正确。

### 错误：数据不完整
检查 Excel 文件中的列名是否与脚本期望的列名匹配。

### 数据未更新
确保运行脚本后刷新了浏览器页面。

## 技术细节

- 使用 `xlsx` 包读取 Excel 文件
- 自动处理中文、英文、俄文三语数据
- 自动分配类别图标和多语言类别名称
- 生成格式化的 TypeScript 代码